<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=windows-1252"/>
	<title>Change log for the Motley library</title>
	<meta name="generator" content="LibreOffice 4.3.5.2 (Windows)"/>
	<meta name="created" content="00:00:00"/>
	<meta name="changed" content="2015-02-10T10:48:52.203000000"/>
	<meta name="description" content="The Motley IDL Library"/>
	<meta name="Info 1" content=""/>
	<meta name="Info 2" content=""/>
	<meta name="Info 3" content=""/>
	<meta name="Info 4" content=""/>
	<style type="text/css">
		p { color: #000000 }
		h1 { color: #000000 }
		h2 { color: #000000 }
		h2.cjk { font-family: "SimSun" }
		h2.ctl { font-family: "Mangal" }
		pre { color: #000000 }
		pre.cjk { font-family: "NSimSun", monospace }
	</style>
</head>
<body lang="en-US" text="#000000" dir="ltr" style="background: transparent">
<h1>Change log for the Motley Library
</h1>
<p><a href="mailto:m.hadfield@niwa.co.nz%20%28Mark%20Hadfield%29">Mark
Hadfield</a>
</p>
<p>Motley is a library of <a href="http://www.rsinc.com/idl/">IDL</a>
code written largely by Mark Hadfield at <a href="http://www.niwa.co.nz/">NIWA</a>.
This document describes major and/or widespread changes to the
routines in the library. For a routine-specific change log, see the
individual documentation headers.
</p>
<p>Entries are in reverse chronological order (most recent first).</p>
<h2 class="western">2016-02-29</h2>
<p>The Motley library now requires IDL >= 8.5.</p>
<p>I removed checksum32 and mgh_struct_hash and added a new MGH_HASHCODE function that
uses the hashcode static method of the IDL_Variable class.</p>
<h2 class="western">2015-04-23</h2>
<p>Added a copy of CHECKSUM32 from the IDL Astronomy Library, required by MGH_STRUCT_HASH.</p>
<h2 class="western">2015-02-10</h2>
<p>Preparing for uploading code to Sourceforge.</p>
<p>The MGH_LINE_COEFF and MGH_POLYFILLA have been moved into the
Motley library from my personal IDL library.</p>
<p>Removed avi.dll, as it only works on Win32, and I think doesn't
work on that anymore either.</p>
<h2 class="western">2011-07-26</h2>
<p>A lot more IDL 8 dependencies have been introduced.</p>
<p>The ToArray method of the MGH_Vector class has been overhauled and
now supports a FLATTEN keyword, directing it to generate a 1D array
from a collection of arrays of different sizes and shapes. This
proves very useful in compiling and processing large collections of
bathymetry data.</p>
<h2 class="western">2010-11-08
</h2>
<p>Getting ready to publish the code on David Fanning's site, if
he'll let me. The code now depends on IDL 8 in several places, and on
IDL 8.0.1 in at least one place (multi-page PDF output of animations
in MGH_Player).</p>
<h2 class="western">2010-10-28
</h2>
<p>The MGHncFile and MGHncReadFile classes can now handle either
'INT' or 'SHORT' as the datatype specifier for 2-byte, integer netCDF
variables. This is to cope with changes in the NCDF_VARINQ function,
which has returned one or other in different IDL versions and now
(IDL 8.0) returns 'INT'.</p>
<h2 class="western">2010-10-20
</h2>
<p>I made the first backwards-incompatible changes: class
MGH_GUI_Base now inherits IDL_Object (giving instances of the class
access to operator overloading and the dot notation); MGH_Window now
exports to PDF using the new IDLgrPDF class.</p>
<h2 class="western">2010-10-18
</h2>
<p>I have (finally) installed IDL 8.0 on my computer. All code to
date is compatible with IDL 7.1 or earlier (most of it works with
versions back to 6.x). With the big changes in 8.0, I will not be
attempting to maintain compatibility with pre-8.0 versions in future.</p>
<h2 class="western">2010-09-15
</h2>
<p>There have been quite a few undocumented changes over the last
year.</p>
<p>One significant recent one is the fixing of a performance bug in
the MGHncSequence class: the VarGet method was calling a function
that effectively looped over the files in the sequence, inside a loop
over the same files. This crippled performance when the number of
files in the sequence approached 1000 or so.</p>
<h2 class="western">2009-09-28
</h2>
<p>In an effort to streamline code for dealing with grids, I added
two new functions: MGH_SUBSET2 (a 2D counterpart for MGH_SUBSET) and
MGH_PERIM. Also, the &ldquo;point inside polygon&rdquo; functions
MGH_POLY_INSIDE and MGH_PNPOLY were made more flexible in how they
require the polygon vertex data and the argument order was changed:
the polygon vertex array(s) come at the end.
</p>
<h2 class="western">2009-08-24
</h2>
<p>Motley code now being stored in an SVN repository. SVN ID
information is recorded in a comment on the first line of each .pro
file.</p>
<h2 class="western">2009-07-13
</h2>
<p>Fixed a few netCDF bugs reported by Foldy Lajos.</p>
<h2 class="western">2009-04-28
</h2>
<p>Changes have been made to the MGHgrGraph class to accommodate the
change in IDLgrWindow resolution in IDL version 7.1. (Previously the
value was queried from the OS but in 7.1 it is set to a fixed 72
dpi). A new routine called MGH_GRAPH_DEFAULT provides defaults for
several of MGHgrGraph's properties. In the case of the SCALE and
FONTSIZE properties these are version-dependent.
</p>
<h2 class="western">2007-11-28
</h2>
<p>David Fanning's PROGRAMROOTDIR is no longer used by any of the
routines, so is no longer bundled with the libary.</p>
<h2 class="western">2007-06-13
</h2>
<p>This version of the library is now being used and developed under
IDL 6.4 (but uses few, if any, features from versions later than
6.2).</p>
<p>I fixed a bug in MGHncFile reported by Matthew Savoie: UNLIMITED
property incorrect&nbsp;when the first dimension in the file is
unlimited.</p>
<p>I cleaned up a lot of broken or non-functional code in the
MGH_DGplayer class. It's all working as it should now, I think.
</p>
<h2 class="western">2006-05-08
</h2>
<p>This version of the library is now being used and developed under
IDL 6.3 (however it does not yet include any features specific to
that version). The AVI-writing code in MGH_Player now uses Oleg
Kornilov's AVI DLL, called via a class called MGHaviWriteFile. There
must be a copy of the DLL in the Motley library directory.
</p>
<h2 class="western">2006-03-10
</h2>
<p>Getting ready for another release. Sticky-directory code has been
added to the file-saving code for all file types in MGH_Window and
MGH_Player.
</p>
<h2 class="western">2004-11-08
</h2>
<p>I am starting to add &ldquo;sticky directory&rdquo; support to the
file-saving process. A new system variable, !MGH_PREFS, is now
created by MGH_MOTLEY. It has a tag called &ldquo;sticky&rdquo; that
specifies if sticky directories are to be enabled. Code is being
added to the file-saving code for various GUIs to change the
directory name if necessary. This is all currently in prototype form:
it has not been implemented fully and details may change. Other
preferences may be added and I may try to use the IDL 6.1 support for
application user directories.
</p>
<h2 class="western">2004-08-30
</h2>
<p>Removed the MGH_RANDOM_NAME routine in favour of <a href="http://astrog.physics.wisc.edu/%7Ecraigm/idl/idl.html">Craig
Markwardt&rsquo;s</a> CMUNIQUE_ID.
</p>
<h2 class="western">2004-06-28
</h2>
<p>Fixes to MGH_NCDF_SAVE and a new example program,
MGH_EXAMPLE_NCSAVE.
</p>
<h2 class="western">2004-06-25
</h2>
<p>Added a routine called MGH_LOOP, which starts a widget application
that executes a widget-processing loop. This allows non-blocking
widgets to be used to examine data while execution is stopped at a
breakpoint.
</p>
<h2 class="western">2004-06-24
</h2>
<p>I have implemented and tested a number of IDL 6.1 new features,
especially keyboard accelerators, which have proved especially useful
for the MGH_animator object.
</p>
<h2 class="western">2004-05-14
</h2>
<p>This copy of the library now being developed with IDL 6.1.
</p>
<h2 class="western">2004-03-18
</h2>
<p>Tested recent changes and bundled up a new version.
</p>
<h2 class="western">2003-08-19
</h2>
<p>With IDL 6.0 having been out for a while, this version of the
library has now been published on my WWW site.
</p>
<h2 class="western">2003-06-12
</h2>
<p>This version of the library makes extensive use of IDL 6.0
features. Latest change is to remove the MGH_FILE_LINES function.
</p>
<h2 class="western">2003-05-12
</h2>
<p>This version of the library is now being developed under IDL 6.0.
First change: delete the MGH_NOT function and start making use of the
new logical operators.
</p>
<h2 class="western">2003-02-17
</h2>
<p>The library now has a publicly accessible <a href="http://www.dfanning.com/hadfield/README.html">home</a>
on David Fanning's site.
</p>
<h2 class="western">2003-01-12
</h2>
<p>Added MGH_NOT, my implementation of the &ldquo;logical not&rdquo;
operation described in my <a href="http://www.dfanning.com/tips/bitwiselogical.html">article</a>
on David Fanning&rsquo;s site
</p>
<h2 class="western">2002-12-24
</h2>
<p>I finally decided it is rather silly to make all routines in this
library backward-incompatible with the STRICTARRSUBS compiler option,
so I stripped all occurrences out.
</p>
<h2 class="western">2002-12-23
</h2>
<p>The library now does a better job of supporting alternative
colour-table files. It recognises a routine, MGH_CT_FILE, which
returns the name of colour-table files and a system variable,
!MGH_CT_FILE, which specifies the user's default. The
MGH_GUI_Palette_Editor widget application recognises this variable
and requires a modified palette editor, MGH_CW_PALETTE_EDITOR.
</p>
<h2 class="western">2002-12-18
</h2>
<p>Inspired by a recent discussion on comp.lang.idl-pvwave, I have
revised the MGH_TXT_RESTORE function (now much faster) and written a
new function, MGH_FILE_LINES, which replaces MGH_N_LINES.
MGH_FILE_LINES calls the new FILE_LINES function if applicable,
otherwise it achieves the same effect with IDL code.
</p>
<h2 class="western">2002-12-10
</h2>
<p>I have been preparing the library for release. Support routines
have been moved to the same directory as everything else; the only
such routine currently included is <a href="http://www.gumley.com/">Liam
Gumley</a>'s IMDISP, used in example code.
</p>
<h2 class="western">2002-11-25
</h2>
<p>Installed IDL 5.6 final. The Motley code now makes use of several
IDL 5.6 features, notably the STRICTARRSUBS compiler option.
</p>
<h2 class="western">2002-10-09
</h2>
<p>Testing &amp; developing library under IDL 5.6 beta. Since IDL 5.6
has a PRODUCT routine, all references to Craig Markwardt's CMPRODUCT
have been removed.
</p>
<h2 class="western">2002-02-01
</h2>
<p>I have now access to Linux via a dual-boot arrangement and have
been testing out this library on it. Some inappropriate settings in
the object graphics applications were discovered and eliminated.
</p>
<h2 class="western">2002-01-14
</h2>
<p>Having installed <a href="http://www.xemacs.org/">XEmacs</a> &amp;
<a href="http://idlwave.org/">IDLWAVE</a>, I have been reformatting
the routines in this library as I visit them.
</p>
<h2 class="western">2000-10-19
</h2>
<p>The MGHgrGLaxis class and the MGH_EXAMPLE_GLAXIS routine, which
were pulled from the library a year ago because they didn't work in
IDL 5.4, have been reinstated. It seems they worked all along!
</p>
<h2 class="western">2001-10-15
</h2>
<p>I added a subdirectory called &quot;support&quot; to contain other
people's routines that are required by the Motley library. I added
<a href="http://astrog.physics.wisc.edu/%7Ecraigm/idl/idl.html">Craig
Markwardt</a>'s CMPRODUCT to this directory then deleted my
MGH_PRODUCT and all references to it.
</p>
<h2 class="western">2001-09-25
</h2>
<p>Library name changed to &quot;Motley&quot;. There is now an
initialisation procedure called MGH_MOTLEY. It reads in message-block
info and sets up a printer. I expect to expand this routine in
future.
</p>
<h2 class="western">2001-09-01
</h2>
<p>This version of the library is now being developed on IDL 5.5
beta. An aggressive (but easily reversible) programme of replacing
_EXTRA with _STRICT_EXTRA means it is not backward-compatible. This
has caught several bugs! Also note that IDL 5.5 has fixed the keyword
precedence bug I identified with inheritance by reference so I am now
using this everywhere.
</p>
<h2 class="western">2001-07-16
</h2>
<p>In the past month I have modified all my GUI code substantially,
incorporating the changes mentioned in the previous entry and many
others besides. See comments in MGH_GUI_Base.
</p>
<h2 class="western">2001-06-14
</h2>
<p>Having examined Martin Schultz's GUI objects I am revisiting some
of my widget-object code (see MGHwidgetBase). Changes made so far
include:
</p>
<ul>
	<li/>
<p style="margin-bottom: 0cm">Allow each widget to specify its
	own event-handler method by&nbsp; storing a structure in the UVALUE.
		</p>
	<li/>
<p>Change the convention for the return values of
	event-handler methods. They used to return 1 to indicate that the
	event has been handled, otherwise 0. Now they follow the convention
	used by IDL's event-handler functions, i.e. return any non-structure
	value (conventionally 0) to indicate that the event has been
	handled, otherwise return a structure (often the original event
	structure) which can then be handled by other event-handlers.
	</p>
</ul>
<p>The latter change introduces a significant
backward-incompatibility. I have modified the main graphics display
classes&mdash;i.e. MGHgrWindow, MGHgrAnimator and MGHgrDatamator&mdash;and
some but not all of the others. (Actually it seems to break less code
than one would expect, possibly because most old-style widget
handlers return 1, which indicates completion under both schemes.)
</p>
<h2 class="western">2001-05-31
</h2>
<p>I added some new time-handling functions, with names beginning
with MGH_DT. I am attempting to handle time zones in a rational way
but this is turning out to be difficult.
</p>
<h2 class="western">2001-05-01:
</h2>
<p>Following from the previous comment, I have further changed a few
classes (MGHgrDensityPlane, MGHgrColorPlane, MGHgrColorPolygon) so
that they pass their _EXTRA keywords to the superclass and not to the
embedded atom. This has doubtless introduced further bugs, which I am
squashing as I find them.
</p>
<h2 class="western">2001-03-13:
</h2>
<p>Discovered and fixed a bug that was uncovered by changes to the
MGHgrAnimator class. Many of my composite atom objects (like
MGHgrDensityPlane) inherit from IDLgrModel but their GetProperty and
SetProperty methods pass _EXTRA keywords to the embedded atom. This
was done so that the composite atom could expose as much of the
embedded atom's functionality as possible. However it may be unwise.
For example in the case of MGHgrDensityPlane objects, code like the
following
</p>
<pre class="western">      odensity-&gt;GetProperty, PARENT=parent
   </pre><p>
was returning a reference to the embedded atom's parent, whereas
MGHgrAnimator was expecting (reasonably) that it would return the
MGHgrDensityPlane's parent. I have fixed the behaviour of
MGHgrDensityPlane &amp; a few other similar classes so that they give
the latter behaviour. I note it here because similar pitfalls have
bitten me before and probably will do again.
</p>
<h2 class="western">2001-01-31:
</h2>
<p>Mouse-event handling for the MGHgrWindow and MGHgrAnimator classes
has been overhauled. The event handers are now objects; the classes
defining these objects are now collected in the procedure
MGH_MOUSE_HANDLER_LIBRARY.
</p>
<h2 class="western">2000-12-15:
</h2>
<p>Various improvements to the MGHgrAnimator class including the
CUMULATIVE and DISPLAY keywords.
</p>
<h2 class="western">2000-12-08:
</h2>
<p>I added the MGHgrImageAnimator class and an example program.
</p>
<h2 class="western">2000-11-30:
</h2>
<p>I added a new function called MGH_STRUCT_BUILD that builds up an
anonymous structure from a list of tag names and a pointer array of
the same size containing data. I took advantage of this function to
rewrite the MGHncFile class's Retrieve method, which becomes much
more readable and flexible as a result. I moved my MGH_NCDF_RESTORE
and MGH_NCDF_SAVE (which I have used for many years) into the
library.
</p>
<h2 class="western">2000-11-07:
</h2>
<p>Copied files to
http://katipo.niwa.cri.nz/~hadfield/gust/software/idl/.
</p>
<p>IDL 5.3 version moved to
http://katipo.niwa.cri.nz/~hadfield/gust/software/idl53/.
</p>
<h2 class="western">2000-10-24:
</h2>
<p>Various minor changes following release of IDL 5.4. The
MGHgrGLaxis class and the MGH_EXAMPLE_GLAXIS routine have been pulled
from the library because 5.4 final appears to have removed support
for subclassing of the (undocumented) IDLgrAxis::Draw method.
</p>
<h2 class="western">2000-09-04:
</h2>
<p>Code-timing routines MGH_TIME_FUNCTION and MGH_TIME_PROCEDURE have
been yanked from the library and replaced by the much simpler MGH_TIC
and MGH_TOC.
</p>
<h2 class="western">2000-08-28:
</h2>
<p>I have been revisiting keyword precedence. If one can rely on
inherited keywords always overriding explicit keywords then one can
simplify code and achieve more flexible control of the components of
complicated objects (e.g. MGH_Plot). In doing so I discovered what I
think is a bug in the implementation of inheritance by reference. See
routine MGH_EXAMPLE_KEYWORDS and recent newsgroup discussions. The
upshot of this is, I think, that when keywords are used only to pass
information into a routine (e.g. a SetProperty or Init method) then
value inheritance should always be used, even if this entails some
performance cost. I have had a quick run through the code applying
this convention.
</p>
<h2 class="western">2000-08-14:
</h2>
<p>Added a couple of date-time routines, MGH_DT_JULDAY and
MGH_DT_CALDAT to the library. Added an example using MGHgrGLaxis for
date-time plotting.&nbsp; This example requires IDL 5.4 or later.
</p>
<h2 class="western">2000-08-10:
</h2>
<p>I introduced the MGHgrMSaxis class (&quot;MS&quot; stands for
&quot;master-slave&quot;). An axis belonging to the class can keep
track of objects (slaves) that have been associated with it and
updates the slaves if any of the its relevant properties are changed.
The MGHgrGraph classes have been modified so they can use
master-slave axes--the default is still not to.&nbsp; The
modifications were surprisingly easy and localised because the graph
class already scales atoms to axes when it adds the atoms to the
graph.&nbsp; The purpose of the MS axes is to make it easier to
organise modify complex graphs, without having to keep information
about associations at the higher levels. I have already used it to
good effect in the MGH_Plot class.
</p>
<p>In the course of checking library integrity I discovered to my
surprise that the PRODUCT routine that I have used here &amp; there
is not* a standard IDL routine. I checked around for good PRODUCT
routines and eventually created an MGH_PRODUCT based on Craig
Markwardt's CMPRODUCT.
</p>
<h2 class="western">2000-08-08:
</h2>
<p>Renamed RefreshWidgets methods throughout the library to
UpdateWidgets.&nbsp; This method reviews and updates widget
appearance based on the state of the application. I think the new
name reflects this better. The method should not normally be called
from outside the object methods so the name change should not cause a
problem.
</p>
<p>Removed the NewText method from the MGHgrGraph2D and MGHgrGraph2D
classes (which therefore now inherit MGHgrGraph::NewText unchanged).
The ability to add titles is now provided in a separate method called
NewTitle. For rationale see documentation for MGHgrGraph2D or
MGHgrGraph2D. This change will cause older codes to put titles in the
wrong place.
</p>
<h2 class="western">2000-08-04:
</h2>
<p>Did a bit of cleaning up, eliminating a few routines of doubtful
utility and also getting rid of procedure wrappers for graphics
objects.
</p>
<h2 class="western">2000-08-03:
</h2>
<p>Pulled out all the date-time (MGHDT...) routines plus related
graphics routines pending a rewrite.
</p>
<h2 class="western">2000-08-02:
</h2>
<p>Created this file. The library currently includes 25889 lines of
code &amp; comments (but a lot of them are empty!) in 134 .pro files.
</p>
<p>I recently did a pretty major restructuring of the graph classes,
replacing existing classes MGHgrView, MGHgrGraph, MGHgrFixedGraph &amp;
MGHgrGraph3D with MGHgrGraph (similar to the old MGHgrView),
MGHgrGraph2D (merges the old MGHgrGraph &amp; MGHgrFixedGraph) and
MGHgrGraph3D (similar to the old class of the same name but much of
the logic has been moved to the superclass MGHgrGraph). Nevertheless
most codes built on the old classes should work fine, once names
MGHgrFixedGraph and MGHgrView are replaced by MGHgrGraph2D and
MGHgrGraph, respectively.
</p>
<hr size="3"/>

<p><a href="mailto:m.hadfield@niwa.co.nz%20%28Mark%20Hadfield%29">Mark
Hadfield</a>
</p>
</body>
</html>
